<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: DetectorSimulation.md Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d4/d6b/DetectorSimulation_8md.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">DetectorSimulation.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d4/d6b/DetectorSimulation_8md.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;!-- doxy</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;\page refdocDetectorSimulation Detector Simulation</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;/doxy --&gt;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;# Detector simulation documentation</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;The present document collects information about the ALICE detector simulation executable and digitization procedure used in LHC Run3.</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;## Overview</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;Detector simulation, the simulation of detector response from virtual particle events, consists of essentialy 2 parts:</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  a) the generation of simple (energy deposit) traces in the detector due to the passage of particles and the interaction with the detector material.</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  b) the conversion of those traces into (electronic) signals in the detector readout (usually called digitization).</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;The first part is handled by the `o2-sim` executable. The second part is handled in the `o2-sim-digitizer-workflow`.</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;# Documentation of `o2-sim`</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;The purpose of the `o2-sim` executable is to simulate the passage of particles emerging from a collision inside the detector and to obtain their effect in terms of energy deposits (called hits) which could be converted into detectable signals.</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;## Command overview</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;* **Basic help:** Help on command line options can be obtained with `o2-sim --help`</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;* **Typical example:** A typical (exemplary) invocation is of the form </div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    ```o2-sim -n 10 -g pythia8 -e TGeant4 -j 2 --skipModules ZDC,PHS``` </div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    which would launch a simulation for 10 pythia8 events on the whole ALICE detector but ZDC and PHOS, using Geant4 on 2 worker processes.</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;* **Generated output**: The simulation creates at least the following files:</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;     </div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;     </div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        | file              | description      |</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        | ----------------- | ---------------- |</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        | `o2sim.root`      | contains kinematics and hits |</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        | `O2geometry.root` | contains the ROOT geometry created for simulation |</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        | `o2sim_grp.root`  | the grp parameters |</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;## Main configuration Options</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;control of verbosity</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;## Configuration via Parameters</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;## Help on available generators</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;Below some notes on example generators along with some usage info.</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;* **Fwmugen**</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;fwmugen is a lightweight and simple “box” generator for forward muons (1 muon / event)</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;```</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;o2-sim -m MFT -e TGeant3 -g fwmugen -n 10</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;```</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;* **BoxGen**</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;```</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;o2-sim -m PIPE ITS MFT -e TGeant3 -g boxgen -n 10 --configKeyValues &#39;BoxGun.pdg=13 ; BoxGun.eta[0]=-3.6 ; BoxGun.eta[1]=-2.45; BoxGun.number=100&#39;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;```</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;* **PYTHIA 8**</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;Configures pythia8 for min.bias pp collisions at 14 TeV</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;```</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;o2-sim -m PIPE ITS MFT -g pythia8 -n 50</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;```</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;## Control via environment variables</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;`o2-sim` is sensitive to the following environment variables:</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;**ALICE_O2SIM_DUMPLOG**</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;**ALICE_O2SIM_USESHM**</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;[Describe in detail the environment variables]</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;## Data layout</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;[Add something on data layout of hits file]</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;## F.A.Q.</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;You may contribute to the documentation by asking a question</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;#### 1. **How can I interface an event generator from ALIROOT**?</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;In order to access event generators from ALIROOT, such as `THijing` or `TPyhtia6`, you may use the `-g extgen` command line option followed by a ROOT macro setting up the event </div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;generator. Examples thereof are available in the installation directory `$O2_ROOT/share/Generators/external`.</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;For example, in order to simulate with 10 Pythia6 events, the following command can be run:</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;```</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;o2-sim -n 10 -g extgen --extGenFile $O2_ROOT/share/Generators/external/pythia6.C</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;```</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;Macro arguments can be passed via</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;`--extGenFunc pythia6(14000., &quot;pythia.settings&quot;)`.</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;Users may write there own macros in order to customize to their needs.</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;#### 2. **How can I run on a subset of geometry modules**?</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;Use the `--modules` or `-m` command line option. Example: `o2-sim -m PIPE ITS TPC`</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;will run the simulation on a geometry/material consinsting of PIPE, ITS, TPC.</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;#### 3. **How can I run with exactly the same events as used in an AliRoot simulation?**</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;One may perform any arbitrary simulation with AliRoot and reuse the kinematics information in form of `Kinemtatics.root`</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;produced. The file contains primary and possibly secondary particles (added by transportation). </div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;When the file is passed to `o2sim`, the primary particles my be used as the initial event. </div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;Use the **`-g extkin`** command line option:</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;```</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;o2-sim -g extkin --extKinFile Kinematics.root ...</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;```</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;#### 4. **How can I generate events (signal) using the vertex position of already-generated (background) events?**</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;This process might be called embedding, where one wants to merge two events generated independenly. For that to be physically correct, both events have to originate from the same interaction vertex.</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;Assuming that your already-generated (background) events are stored in the `o2sim.background.root` file, you can force the interaction vertex for the generation of a new set of events to be the same as the one in the background with the following command line option:</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;```</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;o2-sim --embedIntoFile o2sim.background.root</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;```</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;Background events are sampled one-by-one until all events have been used. At that point the events start to be reused.</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;#### 5. **How can I obtain detailed stepping information?**</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;Run the simulation (currently only supported in combination with `o2-sim-serial`) with a preloaded library:</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;```</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;MCSTEPLOG_TTREE=1 LD_PRELOAD=$O2_ROOT/lib/libMCStepLogger.so o2-sim-serial -j 1 -n 10</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;```</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;This will produce a file `MCStepLoggerOutput.root` containing detailed information about steps and processes (where, what, ...). The file can be analysed using a special analysis framework. See https://github.com/AliceO2Group/AliceO2/blob/dev/Utilities/MCStepLogger/README.md for more documentation.</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;## Development</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;# Documentation of `o2-sim-digitizer-workflow`</div></div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d4/d6b/DetectorSimulation_8md.html">DetectorSimulation.md</a></li>
    <li class="footer">Generated on Wed Feb 19 2020 20:08:24 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
